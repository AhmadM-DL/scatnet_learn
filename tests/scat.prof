python profile.py
Type Time (%) Time (ms)  Calls       Avg       Min       Max                                               Name
GPU activities:    30.06    27.436     24  1.1432ms  649.16us  1.7265ms  void spatialDepthwiseConvolutionUpdateOutput<f...
GPU activities:    16.48    15.042     24  626.76us  442.69us  825.87us  void kernelPointwiseApply2<TensorTakeOp<float,...
GPU activities:     14.3     13.05     40  326.26us  3.8080us  984.46us  void kernelPointwiseApply3<TensorAddOp<long>, ...
GPU activities:     8.02    7.3207     52  140.78us  52.288us  548.42us  void kernelPointwiseApply2<CopyOp<float, float...
GPU activities:     4.22    3.8499      8  481.24us  310.53us  817.32us  void kernelPointwiseApply3<TensorAddOp<float>,...
GPU activities:     3.79    3.4635     24  144.31us  78.401us  230.18us  void kernelPointwiseApply3<TensorAddOp<float>,...
GPU activities:      3.1    2.8285     18  157.14us  78.881us  231.36us  void kernelPointwiseApply3<TensorSubOp<float>,...
GPU activities:     2.81    2.5662      4  641.55us  465.96us  817.10us  void kernelPointwiseApply3<TensorMulOp<float>,...
GPU activities:     1.91    1.7476      6  291.27us  212.84us  369.96us  void kernelPointwiseApply1<TensorDivConstantOp...
GPU activities:     1.89    1.7213      4  430.33us  312.77us  548.36us  void kernelPointwiseApply2<TensorPowOp<float, ...
GPU activities:     1.87    1.7103      6  285.04us  206.60us  363.30us  void kernelPointwiseApply2<TensorDivConstantOp...
GPU activities:     1.41    1.2855      2  642.73us  468.17us  817.29us  void kernelPointwiseApply3<TensorATan2Op<float...
GPU activities:     1.19    1.0831      2  541.56us  176.13us  906.99us  void nearest_neighbor_4d_kernel<float, float>(...
GPU activities:     0.95   0.86481      2  432.41us  315.05us  549.77us  void kernelPointwiseApply2<Tensor_cos_Float_Op...
GPU activities:     0.95   0.86344      2  431.72us  313.83us  549.61us  void kernelPointwiseApply2<Tensor_sin_Float_Op...
GPU activities:     0.95   0.86248      2  431.24us  313.86us  548.62us  void kernelPointwiseApply2<Tensor_sqrt_Float_O...
GPU activities:     0.94   0.86155      2  430.77us  314.02us  547.53us  void kernelPointwiseApply2<TensorSubConstantOp...
GPU activities:     0.94   0.86072      2  430.36us  313.12us  547.59us  void kernelPointwiseApply2<TensorAddConstantOp...
GPU activities:     0.71   0.65035      6  108.39us  78.817us  138.15us  void kernelPointwiseApply3<TensorAddOp<float>,...
GPU activities:     0.63   0.57454      2  287.27us  209.22us  365.32us  void kernelPointwiseApply2<TensorMulConstantOp...
GPU activities:      0.6   0.54884      1  548.84us  548.84us  548.84us  generate_normal(curandStateMtgp32*, int, float...
GPU activities:     0.48   0.44087      2  220.44us  162.60us  278.28us  void AvePoolForward<float, float, bool=1>(int,...
GPU activities:     0.48   0.43527      6  72.545us  52.609us  92.258us  void kernelPointwiseApply2<Tensor_neg_Float_Op...
GPU activities:     0.33   0.29671      1  296.71us  296.71us  296.71us  void kernelPointwiseApply1<TensorFillOp<float>...
GPU activities:     0.23   0.21181      1  211.81us  211.81us  211.81us                                 [CUDA memcpy DtoD]
GPU activities:     0.12   0.11165     36  3.1010us     928ns  71.585us                                 [CUDA memcpy HtoD]
GPU activities:     0.12   0.10781     96  1.1230us     992ns  1.8560us                                 [CUDA memcpy DtoH]
GPU activities:     0.11   0.10147     24  4.2280us  3.7760us  4.5440us  void kernelReduceAll<long, unsigned int, long,...
GPU activities:      0.1  0.092032     24  3.8340us  3.4880us  4.0320us  void kernelReduceAll<long, unsigned int, long,...
GPU activities:     0.09   0.08336     48  1.7360us     864ns  6.6880us  void kernelPointwiseApply2<TensorMulConstantOp...
GPU activities:     0.07  0.067137     40  1.6780us     704ns  6.4320us  void thrust::cuda_cub::core::_kernel_agent<thr...
GPU activities:     0.05    0.0456     48     950ns     704ns  1.2160us  void kernelPointwiseApply1<TensorFillOp<long>,...
GPU activities:     0.04  0.037952     24  1.5810us  1.4400us  1.7280us  void kernelPointwiseApply2<TensorRemainderOp<l...
GPU activities:     0.04  0.036289     24  1.5120us  1.3760us  1.6320us  void kernelPointwiseApply2<CopyOp<float, float...
GPU activities:     0.01  0.007264      8     908ns     864ns  1.0880us                                      [CUDA memset]
         Total:    99.99   91.2666    615                                                                                 
Total (no mem):    99.52   90.8353    482                                                                                 
     API calls:    98.28   4880.31     23  212.19ms  16.919us  4.87170s                                         cudaMalloc
     API calls:     1.34    66.495    124  536.25us  2.0110us  14.402ms                              cudaStreamSynchronize
     API calls:     0.14    6.8563    474  14.464us  7.1880us  128.45us                                         cudaLaunch
     API calls:     0.05    2.4261   5465     443ns     327ns  12.660us                                      cudaGetDevice
     API calls:     0.05    2.2552    125  18.041us  9.1300us  69.261us                                    cudaMemcpyAsync
     API calls:     0.04    2.2168    185  11.982us     164ns  522.73us                               cuDeviceGetAttribute
     API calls:     0.04    2.1929      2  1.0965ms  1.0947ms  1.0983ms                            cudaGetDeviceProperties
     API calls:     0.02   0.95242   1836     518ns     357ns  4.8550us                                      cudaSetDevice
     API calls:     0.01   0.48996   2364     207ns     138ns  1.0090us                                  cudaSetupArgument
     API calls:     0.01   0.37068      2  185.34us  176.64us  194.04us                                   cuDeviceTotalMem
     API calls:     0.01   0.29401      8  36.751us  16.383us  115.01us                                    cudaMemsetAsync
     API calls:        0   0.21936      2  109.68us  107.49us  111.88us                                    cuDeviceGetName
     API calls:        0   0.16486     40  4.1210us  3.6360us  5.7900us                              cudaFuncGetAttributes
     API calls:        0   0.16014      8  20.017us  7.0070us  86.467us                                         cudaMemcpy
     API calls:        0   0.14162    474     298ns     198ns  1.0490us                                  cudaConfigureCall
     API calls:        0   0.12742    508     250ns     148ns  1.7070us                                   cudaGetLastError
     API calls:        0  0.027908     40     697ns     511ns  1.1360us                             cudaDeviceGetAttribute
     API calls:        0  0.016236     80     202ns     136ns     315ns                                cudaPeekAtLastError
     API calls:        0  0.006529     21     310ns     141ns  1.1130us                                 cudaGetDeviceCount
     API calls:        0  0.002626      4     656ns     163ns  1.8890us                                   cuDeviceGetCount
     API calls:        0   0.00114      3     380ns     196ns     679ns                                        cuDeviceGet
     API calls:        0  0.001001      1  1.0010us  1.0010us  1.0010us                                             cuInit
     API calls:        0  0.000685      1     685ns     685ns     685ns                                 cuDriverGetVersion
         Total:    99.99   4965.73  11790