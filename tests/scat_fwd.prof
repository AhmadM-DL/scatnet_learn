python profile.py --no-grad
Type Time (%) Time (ms) Calls       Avg       Min       Max                                               Name
GPU activities:    32.07    14.117    12  1.1764ms  746.31us  1.7123ms  void spatialDepthwiseConvolutionUpdateOutput<f...
GPU activities:    17.09    7.5231    12  626.92us  441.35us  826.92us  void kernelPointwiseApply2<TensorTakeOp<float,...
GPU activities:    15.05     6.622    20  331.10us  4.2560us  974.73us  void kernelPointwiseApply3<TensorAddOp<long>, ...
GPU activities:     6.24    2.7444    28  98.015us  51.680us  549.06us  void kernelPointwiseApply2<CopyOp<float, float...
GPU activities:     4.95    2.1765    12  181.37us  131.20us  231.46us  void kernelPointwiseApply3<TensorSubOp<float>,...
GPU activities:     4.92    2.1641    12  180.34us  131.04us  229.83us  void kernelPointwiseApply3<TensorAddOp<float>,...
GPU activities:     3.91    1.7194     4  429.85us  311.88us  547.34us  void kernelPointwiseApply2<TensorPowOp<float, ...
GPU activities:     3.88    1.7077     6  284.61us  205.57us  363.91us  void kernelPointwiseApply2<TensorDivConstantOp...
GPU activities:     2.91    1.2826     2  641.29us  465.48us  817.10us  void kernelPointwiseApply3<TensorAddOp<float>,...
GPU activities:     1.96   0.86232     2  431.16us  313.38us  548.94us  void kernelPointwiseApply2<TensorSubConstantOp...
GPU activities:     1.96   0.86078     2  430.39us  313.06us  547.72us  void kernelPointwiseApply2<Tensor_sqrt_Float_O...
GPU activities:     1.95   0.85867     2  429.33us  311.75us  546.92us  void kernelPointwiseApply2<TensorAddConstantOp...
GPU activities:     1.25   0.55031     1  550.31us  550.31us  550.31us  generate_normal(curandStateMtgp32*, int, float...
GPU activities:        1   0.44116     2  220.58us  162.40us  278.76us  void AvePoolForward<float, float, bool=1>(int,...
GPU activities:     0.22   0.09853    24  4.1050us     928ns  71.425us                                 [CUDA memcpy HtoD]
GPU activities:     0.12  0.054785    48  1.1410us  1.0240us  1.6320us                                 [CUDA memcpy DtoH]
GPU activities:     0.11  0.047585    12  3.9650us  3.8720us  4.1600us  void kernelReduceAll<long, unsigned int, long,...
GPU activities:      0.1  0.045313    12  3.7760us  3.7120us  3.8720us  void kernelReduceAll<long, unsigned int, long,...
GPU activities:      0.1  0.042048    24  1.7520us     992ns  6.2720us  void kernelPointwiseApply2<TensorMulConstantOp...
GPU activities:     0.08  0.034304    20  1.7150us     832ns  6.0160us  void thrust::cuda_cub::core::_kernel_agent<thr...
GPU activities:     0.05  0.022144    24     922ns     800ns  1.1520us  void kernelPointwiseApply1<TensorFillOp<long>,...
GPU activities:     0.05   0.02064    12  1.7200us  1.6000us  1.8880us  void kernelPointwiseApply2<TensorRemainderOp<l...
GPU activities:     0.04  0.018336    12  1.5280us  1.5040us  1.6000us  void kernelPointwiseApply2<CopyOp<float, float...
         Total:   100.01   44.0137   305                                                                                 
Total (no mem):    99.67   43.8604   233                                                                                 
     API calls:    99.31   5064.69    22  230.21ms  23.407us  5.05612s                                         cudaMalloc
     API calls:     0.42    21.568    64  337.00us  2.1870us  3.0039ms                              cudaStreamSynchronize
     API calls:     0.08    3.9688   233  17.033us  7.5760us  191.38us                                         cudaLaunch
     API calls:     0.05    2.7514   185  14.872us     172ns  622.86us                               cuDeviceGetAttribute
     API calls:     0.05    2.7298     2  1.3649ms  1.3613ms  1.3685ms                            cudaGetDeviceProperties
     API calls:     0.02    1.2578  2690     467ns     343ns  8.1990us                                      cudaGetDevice
     API calls:     0.02    1.1535    64  18.023us  11.765us  44.351us                                    cudaMemcpyAsync
     API calls:     0.01   0.48483   895     541ns     371ns  3.8630us                                      cudaSetDevice
     API calls:     0.01   0.38292     2  191.46us  191.14us  191.78us                                   cuDeviceTotalMem
     API calls:     0.01   0.27042     2  135.21us  134.73us  135.69us                                    cuDeviceGetName
     API calls:     0.01   0.25657  1177     217ns     145ns  2.1000us                                  cudaSetupArgument
     API calls:        0   0.18611     8  23.263us  7.4880us  102.10us                                         cudaMemcpy
     API calls:        0   0.10414    20  5.2070us  3.7570us  15.837us                              cudaFuncGetAttributes
     API calls:        0  0.070834   233     304ns     176ns  1.8990us                                  cudaConfigureCall
     API calls:        0  0.067218   246     273ns     157ns  1.8780us                                   cudaGetLastError
     API calls:        0  0.016367    20     818ns     500ns  2.8990us                             cudaDeviceGetAttribute
     API calls:        0  0.008848    40     221ns     140ns     373ns                                cudaPeekAtLastError
     API calls:        0   0.00559    17     328ns     138ns  1.2710us                                 cudaGetDeviceCount
     API calls:        0  0.002695     4     673ns     159ns  1.8500us                                   cuDeviceGetCount
     API calls:        0  0.001271     3     423ns     169ns     840ns                                        cuDeviceGet
     API calls:        0   0.00098     1     980ns     980ns     980ns                                             cuInit
     API calls:        0  0.000792     1     792ns     792ns     792ns                                 cuDriverGetVersion
         Total:    99.99   5099.98  5929